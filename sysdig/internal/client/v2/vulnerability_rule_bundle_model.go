package v2

type VulnerabilityRuleBundle struct {
	ID          *int                `json:"id,omitempty"`
	Name        string              `json:"name"`
	Identifier  *string             `json:"identifier,omitempty"`
	Description *string             `json:"description,omitempty"`
	Rules       []VulnerabilityRule `json:"rules"`
}

type VulnerabilityRule struct {
	ID         *string                      `json:"ruleId,omitempty"`
	Type       VulnerabilityRuleType        `json:"ruleType"`
	Predicates []VulnerabilityRulePredicate `json:"predicates"`
}

type VulnerabilityRulePredicate struct {
	Type  string                           `json:"type"`
	Extra *VulnerabilityRulePredicateExtra `json:"extra,omitempty"`
}

type VulnerabilityRulePredicateExtra struct {
	Level    *Level    `json:"level,omitempty"`
	Age      *int      `json:"age,omitempty"`
	VulnIDS  []string  `json:"vulnIds,omitempty"`
	Value    *Value    `json:"value,omitempty"`
	Packages []Package `json:"packages,omitempty"`
	Key      *string   `json:"key,omitempty"`
	User     *string   `json:"user,omitempty"`
	PkgType  *string   `json:"pkgType,omitempty"`
}

type Package struct {
	Name    string `json:"name"`
	Version string `json:"version"`
}

type Level string

const (
	Critical Level = "critical"
	High     Level = "high"
	Medium   Level = "medium"
)

type VulnerabilityRuleType string

const (
	VulnerabilityRuleTypeImageConfigCreationDate                   VulnerabilityRuleType = "imageConfigCreationDate"
	VulnerabilityRuleTypeImageConfigDefaultUser                    VulnerabilityRuleType = "imageConfigDefaultUser"
	VulnerabilityRuleTypeImageConfigEnvVariable                    VulnerabilityRuleType = "imageConfigEnvVariable"
	VulnerabilityRuleTypeImageConfigInstructionIsPkgManager        VulnerabilityRuleType = "imageConfigInstructionIsPkgManager"
	VulnerabilityRuleTypeImageConfigInstructionNotRecommended      VulnerabilityRuleType = "imageConfigInstructionNotRecommended"
	VulnerabilityRuleTypeImageConfigLabel                          VulnerabilityRuleType = "imageConfigLabel"
	VulnerabilityRuleTypeImageConfigSensitiveInformationAndSecrets VulnerabilityRuleType = "imageConfigSensitiveInformationAndSecrets"
	VulnerabilityRuleTypePkgDenyList                               VulnerabilityRuleType = "pkgDenyList"
	VulnerabilityRuleTypeVulnDenyList                              VulnerabilityRuleType = "vulnDenyList"
	VulnerabilityRuleTypeVulnSeverityAndThreats                    VulnerabilityRuleType = "vulnSeverityAndThreats"
)

type Value struct {
	Integer *int64
	String  *string
}
