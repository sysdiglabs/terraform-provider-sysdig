package v2

type VulnerabilityRuleBundle struct {
	ID          *int                `json:"id,omitempty"`
	Name        string              `json:"name"`
	Identifier  *string             `json:"identifier,omitempty"`
	Description *string             `json:"description,omitempty"`
	Rules       []VulnerabilityRule `json:"rules"`
}

type VulnerabilityRule struct {
	ID         *string                      `json:"ruleId,omitempty"`
	Type       VulnerabilityRuleType        `json:"ruleType"`
	Predicates []VulnerabilityRulePredicate `json:"predicates"`
}

type VulnerabilityRulePredicate struct {
	Type  string                           `json:"type"`
	Extra *VulnerabilityRulePredicateExtra `json:"extra,omitempty"`
}

type VulnerabilityRulePredicateExtra struct {
	// Common fields for different predicate types
	Level     *Level    `json:"level,omitempty"`
	Age       *int      `json:"age,omitempty"`
	Days      *int      `json:"days,omitempty"`
	PkgType   *string   `json:"pkgType,omitempty"`
	VulnIDS   []string  `json:"vulnIds,omitempty"`
	Packages  []Package `json:"packages,omitempty"`
	Key       *string   `json:"key,omitempty"`
	User      *string     `json:"user,omitempty"`
	Value     interface{} `json:"value,omitempty"` // For image labels or CVSS score

	// Disclosure Date Range
	StartDate *string `json:"startDate,omitempty"`
	EndDate   *string `json:"endDate,omitempty"`

	// EPSS
	Score      *int `json:"score,omitempty"`
	Percentile *int `json:"percentile,omitempty"`
}

type Package struct {
	Name    string `json:"name"`
	Version string `json:"version"`
}

type Level string

const (
	Critical Level = "critical"
	High     Level = "high"
	Medium   Level = "medium"
)

type VulnerabilityRuleType string

const (
	VulnerabilityRuleTypeImageConfigCreationDate                   VulnerabilityRuleType = "imageConfigCreationDate"
	VulnerabilityRuleTypeImageConfigDefaultUser                    VulnerabilityRuleType = "imageConfigDefaultUser"
	VulnerabilityRuleTypeImageConfigEnvVariable                    VulnerabilityRuleType = "imageConfigEnvVariable"
	VulnerabilityRuleTypeImageConfigInstructionIsPkgManager        VulnerabilityRuleType = "imageConfigInstructionIsPkgManager"
	VulnerabilityRuleTypeImageConfigInstructionNotRecommended      VulnerabilityRuleType = "imageConfigInstructionNotRecommended"
	VulnerabilityRuleTypeImageConfigLabel                          VulnerabilityRuleType = "imageConfigLabel"
	VulnerabilityRuleTypeImageConfigSensitiveInformationAndSecrets VulnerabilityRuleType = "imageConfigSensitiveInformationAndSecrets"
	VulnerabilityRuleTypePkgDenyList                               VulnerabilityRuleType = "pkgDenyList"
	VulnerabilityRuleTypeVulnDenyList                              VulnerabilityRuleType = "vulnDenyList"
	VulnerabilityRuleTypeVulnSeverityAndThreats                    VulnerabilityRuleType = "vulnSeverityAndThreats"
)
