---
subcategory: "Sysdig Secure"
layout: "sysdig"
page_title: "Sysdig: sysdig_secure_vulnerability_policy"
description: |-
  Creates a Sysdig Secure Vulnerability Policy.
---

# Resource: sysdig_secure_vulnerability_policy

Creates a Sysdig Secure Vulnerability Policy.

-> **Note:** Sysdig Terraform Provider is under rapid development at this point. If you experience any issue or discrepancy while using it, please make sure you have the latest version. If the issue persists, or you have a Feature Request to support an additional set of resources, please open a [new issue](https://github.com/sysdiglabs/terraform-provider-sysdig/issues/new) in the GitHub repository.

## Example Usage

```terraform
resource "sysdig_secure_vulnerability_policy" "vulnerability_policy_example" {
  name        = "Vulnerability Policy Name"
  description = "Vulnerability Policy Description"
  bundles     = ["1"]

  stages {
    name = "pipeline"
    configuration {
      scope = "container.image != ''"
    }
  }

  stages {
    name = "admission_control"
    configuration {
      scope                = "kubernetes.cluster.name = 'my-cluster'"
      failure_action       = "reject"
      unknown_image_action = "rejectAndScan"
    }
  }
}
```

## Argument Reference

* `name` - (Required) The unique name of the vulnerability policy.
* `description` - (Optional) A description of the vulnerability policy.
* `bundles` - (Required) Set of bundle IDs associated with the policy.
* `stages` - (Optional) Set defining stages of vulnerability detection.

### Stages block

* `name` - (Required) Must be one of `pipeline`, `registry`, `runtime`, or `admission_control`.
* `configuration` - (Optional) Configuration block for the stage. If no configuration is provided, it will apply to any workload in this stage.

### Configuration block

* `scope` - (Required) Scope expression defining the stage applicability.
* `failure_action` - (Optional) Required for `admission_control` stage only. Policy Failure Action. What should happen if the policy fails (aka: there's a rule vioation). Must be one of `reject` or `warn`.
* `unknown_image_action` - (Optional) Required for `admission_control` stage only. Unknown Image Action. What should happen if the image is unknown. Must be one of `reject`, `rejectAndScan`, or `warn`.

## Attributes Reference

In addition to all arguments above, the following attributes are exported:

* `identifier` - The external identifier computed after creation.

## Import

Secure vulnerability policies can be imported using the policy ID, e.g.:

```
$ terraform import sysdig_secure_vulnerability_policy.example policy_123456
```

